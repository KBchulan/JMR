import{d as k,r as m,J as P,a as B,b as s,n as S,p as z,D as L,e as i,E as b,g as l,i as y,h as E,u as T,K as M,m as o,_ as $,t as f,F as D,f as I,l as N,w}from"./index-CD-uQSen.js";const R={key:0,class:"lazy-image-placeholder"},U=["src","alt"],F={key:1,class:"lazy-image-error"},G=k({__name:"LazyImage",props:{src:{},alt:{},threshold:{}},setup(h){const p=h,n=m(null),c=m(!1),t=m(!1),a=m(!1),r=m(""),{stop:d}=P(n,([{isIntersecting:u}])=>{a.value=u,a.value&&n.value&&!c.value&&!t.value&&(r.value=p.src,n.value.src=r.value)},{threshold:p.threshold||.1});function e(){c.value=!0}function g(){t.value=!0}return B(()=>{d()}),(u,v)=>{const C=y("el-icon");return o(),s("div",{class:S(["lazy-image",{"is-loaded":c.value,"is-error":t.value}])},[!c.value&&!t.value?(o(),s("div",R,v[0]||(v[0]=[i("div",{class:"lazy-image-skeleton"},null,-1)]))):z("",!0),L(i("img",{ref_key:"imgRef",ref:n,src:u.src,alt:u.alt,onLoad:e,onError:g},null,40,U),[[b,c.value]]),t.value?(o(),s("div",F,[l(C,null,{default:E(()=>[l(T(M))]),_:1}),v[1]||(v[1]=i("span",null,"加载失败",-1))])):z("",!0)],2)}}}),j=$(G,[["__scopeId","data-v-8b9e0287"]]),J={class:"comic-cover"},K={class:"comic-info"},O={class:"comic-title truncate"},V={class:"comic-tags"},q={class:"comic-meta"},A={class:"comic-author truncate"},H={class:"comic-update"},Q=k({__name:"ComicCard",props:{comic:{}},setup(h){const p=h,n=N(),c=()=>{n.push(`/comic/${p.comic.id}`)},t=a=>{const r=new Date(a),e=Math.floor((new Date().getTime()-r.getTime())/(1e3*60*60*24));return e===0?"今天":e===1?"昨天":e<7?`${e}天前`:e<30?`${Math.floor(e/7)}周前`:`${r.getMonth()+1}月${r.getDate()}日`};return(a,r)=>(o(),s("div",{class:"comic-card",onClick:c},[i("div",J,[l(j,{src:a.comic.cover,alt:a.comic.title},null,8,["src","alt"]),i("div",{class:S(["comic-status",a.comic.status])},f(a.comic.status==="ongoing"?"连载中":"已完结"),3)]),i("div",K,[i("h3",O,f(a.comic.title),1),i("div",V,[(o(!0),s(D,null,I(a.comic.tags.slice(0,3),d=>(o(),s("span",{key:d,class:"tag"},f(d),1))),128))]),i("div",q,[i("span",A,f(a.comic.author),1),i("span",H,f(t(a.comic.updateTime)),1)])])]))}}),W=$(Q,[["__scopeId","data-v-5611d86c"]]),X={class:"comic-grid"},Y={key:0,class:"loading-container"},Z={key:1,class:"empty-container"},x={key:2,class:"grid-container"},ee={key:3,class:"pagination-container"},ae=k({__name:"ComicGrid",props:{comics:{},loading:{type:Boolean},pagination:{type:Boolean},total:{},defaultPage:{},defaultPageSize:{}},emits:["page-change"],setup(h,{emit:p}){const n=h,c=p,t=m(n.defaultPage||1),a=m(n.defaultPageSize||24);w(()=>n.defaultPage,e=>{e&&(t.value=e)}),w(()=>n.defaultPageSize,e=>{e&&(a.value=e)});const r=e=>{t.value=e,c("page-change",e,a.value)},d=e=>{a.value=e,t.value=1,c("page-change",1,e)};return(e,g)=>{const u=y("el-skeleton"),v=y("el-empty"),C=y("el-pagination");return o(),s("div",X,[e.loading?(o(),s("div",Y,[l(u,{rows:2,animated:""}),l(u,{rows:2,animated:""}),l(u,{rows:2,animated:""}),l(u,{rows:2,animated:""})])):e.comics.length===0?(o(),s("div",Z,[l(v,{description:"暂无漫画"})])):(o(),s("div",x,[(o(!0),s(D,null,I(e.comics,_=>(o(),s("div",{key:_.id,class:"grid-item"},[l(W,{comic:_},null,8,["comic"])]))),128))])),e.pagination&&!e.loading?(o(),s("div",ee,[l(C,{"current-page":t.value,"onUpdate:currentPage":g[0]||(g[0]=_=>t.value=_),"page-size":a.value,"onUpdate:pageSize":g[1]||(g[1]=_=>a.value=_),"page-sizes":[12,24,36,48],background:!0,layout:"total, sizes, prev, pager, next, jumper",total:e.total,onSizeChange:d,onCurrentChange:r},null,8,["current-page","page-size","total"])])):z("",!0)])}}}),se=$(ae,[["__scopeId","data-v-8cac9517"]]);export{se as C,W as a};
